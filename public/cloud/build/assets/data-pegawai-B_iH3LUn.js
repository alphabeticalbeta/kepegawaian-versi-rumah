document.addEventListener("DOMContentLoaded",function(){var b;window.dataPegawaiData={activeTab:"personal",totalTabs:4,progress:0,jenisPegawai:((b=document.querySelector("#jenis_pegawai"))==null?void 0:b.value)||"",formData:{}},window.switchTab=function(a){const t=window.dataPegawaiData.activeTab;if(p(t)){if(window.dataPegawaiData.activeTab=a,window.Alpine){const n=document.querySelector("[x-data]").__x.$data;n.activeTab=a,n.updateProgress()}showToast(`Berpindah ke tab ${v(a)}`,"success")}};function p(a){const n={personal:["nama_lengkap","gelar_belakang"],employment:["jenis_pegawai","status_kepegawaian","pangkat_terakhir_id"],dosen:["mata_kuliah_diampu","ranting_ilmu_kepakaran"],documents:[]}[a]||[];let s=!0,l="";return n.forEach(i=>{const e=document.getElementById(i);e&&e.hasAttribute("required")&&!e.value.trim()?(e.classList.add("border-red-500"),s=!1,l=`Mohon lengkapi field ${i.replace(/_/g," ")}`):e&&e.classList.remove("border-red-500")}),s||showToast(l,"error"),s}function v(a){return{personal:"Data Pribadi",employment:"Data Kepegawaian",dosen:"Data Dosen",documents:"Dokumen"}[a]||a}window.updateProgress=function(){const a=["personal","employment","dosen","documents"];a.indexOf(window.dataPegawaiData.activeTab);let t=0,n=0;a.forEach(e=>{const c={personal:["nama_lengkap","gelar_belakang"],employment:["jenis_pegawai","status_kepegawaian","pangkat_terakhir_id"],dosen:["mata_kuliah_diampu","ranting_ilmu_kepakaran"],documents:[]}[e]||[];n+=c.length,c.forEach(P=>{const h=document.getElementById(P);h&&h.value.trim()&&t++})});const s=n>0?Math.round(t/n*100):0;window.dataPegawaiData.progress=s;const l=document.querySelector(".progress-bar");l&&(l.style.width=`${s}%`,l.setAttribute("aria-valuenow",s));const i=document.querySelector(".progress-text");return i&&(i.textContent=`${s}%`),s},window.showToast=function(a,t="info"){const n=document.createElement("div");n.className="fixed top-4 right-4 z-50 p-4 rounded-lg shadow-lg transform transition-all duration-300 translate-x-full";const s={success:"bg-green-500 text-white",error:"bg-red-500 text-white",warning:"bg-yellow-500 text-black",info:"bg-blue-500 text-white"};n.className+=` ${s[t]||s.info}`,n.innerHTML=`
            <div class="flex items-center justify-between">
                <span>${a}</span>
                <button onclick="this.parentElement.parentElement.remove()" class="ml-4 text-white hover:text-gray-200">
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                    </svg>
                </button>
            </div>
        `,document.body.appendChild(n),setTimeout(()=>{n.classList.remove("translate-x-full")},100),setTimeout(()=>{n.classList.add("translate-x-full"),setTimeout(()=>{n.parentElement&&n.remove()},300)},5e3)};function u(){const a=document.getElementById("jenis_pegawai"),t=document.getElementById("jabatan_terakhir_id");if(!a||!t)return;const n=a.value;if(!n)return;t.querySelectorAll("option").forEach(e=>{if(e.value===""){e.style.display="",e.disabled=!1;return}e.getAttribute("data-jenis-pegawai")===n?(e.style.display="",e.disabled=!1):(e.style.display="none",e.disabled=!0)});const l=t.value,i=t.querySelector(`option[value="${l}"]`);i&&i.style.display==="none"&&(t.value="")}function g(){const a=document.getElementById("jenis_pegawai"),t=document.getElementById("status_kepegawaian");if(!a||!t)return;const n=a.value;if(!n)return;t.querySelectorAll("option").forEach(e=>{if(e.value===""){e.style.display="",e.disabled=!1;return}e.getAttribute("data-jenis-pegawai")===n?(e.style.display="",e.disabled=!1):(e.style.display="none",e.disabled=!0)});const l=t.value,i=t.querySelector(`option[value="${l}"]`);i&&i.style.display==="none"&&(t.value="")}function o(){const a=document.getElementById("jenis_pegawai"),t=document.getElementById("jenis_jabatan");if(!a||!t)return;const n=a.value,s=t.value;if(!n)return;const l=t.querySelectorAll("option");let i=!1;l.forEach((e,f)=>{if(e.value===""){e.style.display="",e.disabled=!1;return}e.getAttribute("data-jenis-pegawai")===n?(e.style.display="",e.disabled=!1):(e.style.display="none",e.disabled=!0,e.value===s&&(i=!0))}),i&&(t.value=""),t.querySelectorAll('option:not([style*="display: none"])')}function d(){const a=document.getElementById("status_kepegawaian"),t=document.getElementById("pangkat_terakhir_id");if(!a||!t)return;const n=a.value;if(!n)return;let s;switch(n){case"Dosen PNS":case"Tenaga Kependidikan PNS":s="PNS";break;case"Dosen PPPK":case"Tenaga Kependidikan PPPK":s="PPPK";break;case"Dosen Non ASN":case"Tenaga Kependidikan Non ASN":s="Non ASN";break;default:s=null}t.querySelectorAll("option").forEach((i,e)=>{if(i.value===""){i.style.display="",i.disabled=!1;return}const c=i.parentElement.label||"";s&&c.includes(s)?(i.style.display="",i.disabled=!1):(i.style.display="none",i.disabled=!0)})}const r=document.getElementById("jenis_pegawai"),w=document.getElementById("status_kepegawaian");r&&w&&(r.value&&(u(),g(),o(),d()),r.addEventListener("change",function(){u(),g(),o(),d()}),w&&w.addEventListener("change",function(){d()})),window.checkAndFixFiltering=function(){const a=document.getElementById("jenis_pegawai"),t=document.getElementById("jenis_jabatan");if(!a||!t)return!1;const n=a.value,s=t.querySelectorAll("option");let l=0,i=0;return s.forEach(e=>{if(e.value==="")return;const f=e.getAttribute("data-jenis-pegawai"),c=e.style.display!=="none";f===n&&(i++,c&&l++)}),l!==i?(o(),!0):!1},window.triggerFilters=function(){document.getElementById("jenis_pegawai")&&(u(),g(),o(),d())},setTimeout(()=>{r&&(u(),g(),o(),d())},100),setTimeout(()=>{r&&(u(),g(),o(),d())},500),setTimeout(()=>{r&&(u(),g(),o(),d(),window.checkAndFixFiltering())},1e3);let y=0;const k=setInterval(()=>{y++,r&&r.value&&window.checkAndFixFiltering(),y>=5&&clearInterval(k)},2e3),m=document.querySelector("form");m&&m.addEventListener("submit",function(a){const t=m.querySelector('button[type="submit"]');t&&(t.disabled=!0);const n=["personal","employment","dosen","documents"];let s=!1;n.forEach(l=>{p(l)||(s=!0)}),s&&(a.preventDefault(),showToast("Mohon lengkapi semua field wajib sebelum menyimpan","error"),t&&(t.disabled=!1))}),document.querySelectorAll("input, select, textarea").forEach(a=>{a.addEventListener("input",function(){updateProgress()}),a.addEventListener("change",function(){updateProgress()})}),setTimeout(()=>{updateProgress()},100),window.successMessage&&showToast(window.successMessage,"success")});
