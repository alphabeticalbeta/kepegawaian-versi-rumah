var g=(m,e)=>()=>(e||m((e={exports:{}}).exports,e),e.exports);import"./utils-ZuXHAGsl.js";var p=g((v,u)=>{class w{constructor(){this.init()}init(){this.setupCsrfToken(),this.initializeSidebar(),this.initializeDropdowns(),this.initializeDataTables(),this.initializeFormValidation(),this.initializeFileUploads(),this.initializeAlerts(),this.initializeUsulanManagement(),this.initializeValidationScripts()}setupCsrfToken(){const e=document.querySelector('meta[name="csrf-token"]');e&&(window.csrfToken=e.getAttribute("content"),window.fetchWithCsrf=function(n,t={}){return t.headers=t.headers||{},t.headers["X-CSRF-TOKEN"]=window.csrfToken,t.headers["X-Requested-With"]="XMLHttpRequest",fetch(n,t)})}initializeIcons(){typeof lucide<"u"&&lucide.createIcons()}initializeSidebar(){const e=document.getElementById("sidebar"),n=document.getElementById("main-content");e&&n&&(window.toggleSidebar=()=>{const t=!e.classList.contains("w-20");e.classList.toggle("w-64",!t),e.classList.toggle("w-20",t),n.style.marginLeft=t?"5rem":"16rem",document.querySelectorAll(".sidebar-text").forEach(i=>{i.classList.toggle("hidden",t)}),t&&document.querySelectorAll(".dropdown-menu").forEach(i=>{i.classList.add("hidden");const a=document.querySelector(`[data-collapse-toggle="${i.id}"]`);if(a){a.setAttribute("aria-expanded","false");const o=a.querySelector('[data-lucide="chevron-down"]');o&&o.classList.remove("rotate-180")}})})}initializeDropdowns(){document.querySelectorAll("button[data-collapse-toggle]").forEach(e=>{e.addEventListener("click",function(n){n.preventDefault(),n.stopPropagation();const t=this.getAttribute("data-collapse-toggle"),i=document.getElementById(t);if(!i)return;const a=i.classList.contains("hidden");a&&document.querySelectorAll(".dropdown-menu").forEach(s=>{if(s.id!==t){s.classList.add("hidden");const r=document.querySelector(`[data-collapse-toggle="${s.id}"]`);if(r){r.setAttribute("aria-expanded","false");const d=r.querySelector('[data-lucide="chevron-down"]');d&&d.classList.remove("rotate-180")}}}),i.classList.toggle("hidden"),this.setAttribute("aria-expanded",a);const o=this.querySelector('[data-lucide="chevron-down"]');o&&o.classList.toggle("rotate-180",a)})})}initializeDataTables(){typeof $<"u"&&typeof $.fn<"u"&&typeof $.fn.DataTable<"u"?$(".datatable").DataTable({responsive:!0,language:{url:"//cdn.datatables.net/plug-ins/1.10.24/i18n/Indonesian.json"}}):console.log("jQuery or DataTables not available, skipping DataTables initialization")}initializeFormValidation(){document.querySelectorAll("form").forEach(n=>{n.addEventListener("submit",function(t){console.log("Form submitted:",n.action)})})}initializeFileUploads(){window.previewUploadedFile=function(e,n){const t=e.files[0],i=document.getElementById(n);if(t){if(t.type!=="application/pdf"){alert("Hanya file PDF yang diperbolehkan!"),e.value="";return}if(t.size>2097152){alert("Ukuran file maksimal 2MB!"),e.value="";return}const a=(t.size/1024/1024).toFixed(2),o=t.name;i&&(i.innerHTML=`
                        <div class="p-3 bg-green-50 border border-green-200 rounded-lg">
                            <div class="flex items-center gap-3">
                                <div class="flex-shrink-0 bg-green-100 rounded-full p-2">
                                    <i data-lucide="file-check" class="w-4 h-4 text-green-600"></i>
                                </div>
                                <div class="flex-1 min-w-0">
                                    <p class="text-sm font-medium text-green-800 truncate">${o}</p>
                                    <div class="flex items-center gap-4 mt-1">
                                        <span class="text-xs text-green-600">Ukuran: ${a} MB</span>
                                        <span class="text-xs text-green-600 flex items-center gap-1">
                                            <i data-lucide="check-circle" class="w-3 h-3"></i>
                                            Siap diupload
                                        </span>
                                    </div>
                                </div>
                                <button type="button" onclick="clearFilePreview('${e.id}', '${n}')"
                                        class="flex-shrink-0 text-green-600 hover:text-green-800">
                                    <i data-lucide="x" class="w-4 h-4"></i>
                                </button>
                            </div>
                        </div>
                    `,i.classList.remove("hidden")),typeof lucide<"u"&&lucide.createIcons()}else i&&i.classList.add("hidden")},window.clearFilePreview=function(e,n){const t=document.getElementById(e),i=document.getElementById(n);t&&(t.value=""),i&&i.classList.add("hidden")}}initializeAlerts(){setTimeout(()=>{document.querySelectorAll(".alert").forEach(n=>{(n.classList.contains("alert-success")||n.classList.contains("alert-error"))&&(n.style.transition="opacity 0.5s ease-out",n.style.opacity="0",setTimeout(()=>n.remove(),500))})},5e3)}initializeUsulanManagement(){window.approveUsulan=function(e){confirm("Apakah Anda yakin ingin menyetujui usulan ini?")&&console.log("Approving usulan:",e)},window.rejectUsulan=function(e){const n=prompt("Masukkan alasan penolakan:");n&&console.log("Rejecting usulan:",e,"Reason:",n)},window.viewUsulanDetail=function(e){console.log("Viewing usulan detail:",e)}}initializeValidationScripts(){window.toggleKeterangan=function(e,n){const t=document.getElementById(`keterangan_${e}`);t&&(n==="tidak_sesuai"?(t.disabled=!1,t.placeholder="Jelaskan mengapa item ini tidak sesuai...",t.focus()):(t.disabled=!0,t.placeholder='Pilih "Tidak Sesuai" untuk mengisi keterangan',t.value=""))},window.resetForm=function(){confirm("Apakah Anda yakin ingin mereset semua validasi?")&&document.querySelectorAll('select[name*="[status]"]').forEach(e=>{e.value="sesuai";const n=e.name.match(/validation\[(\w+)\]\[(\w+)\]/);n&&toggleKeterangan(n[1]+"_"+n[2],"sesuai")})},window.submitValidation=function(e){const n=document.getElementById("validationForm"),t=n.querySelector('input[name="action_type"]');t&&t.remove();const i=document.createElement("input");i.type="hidden",i.name="action_type",i.value="save_only",n.appendChild(i),window.showLoadingState&&window.showLoadingState()},window.showReturnForm=function(){document.getElementById("returnForm").classList.remove("hidden"),document.getElementById("forwardForm").classList.add("hidden"),window.updateValidationIssueSummary&&window.updateValidationIssueSummary()},window.hideReturnForm=function(){document.getElementById("returnForm").classList.add("hidden")},window.showForwardForm=function(){document.getElementById("forwardForm").classList.remove("hidden"),document.getElementById("returnForm").classList.add("hidden")},window.hideForwardForm=function(){document.getElementById("forwardForm").classList.add("hidden")},window.submitReturnForm=function(){const e=document.getElementById("validationForm"),n=document.getElementById("catatan_umum_return");if(!n)return console.error("ERROR: Textarea 'catatan_umum' not found!"),alert("Terjadi error: komponen catatan tidak ditemukan."),!1;const t=n.value;if(!t||t.trim().length<10)return alert("Catatan untuk pegawai wajib diisi minimal 10 karakter."),n.focus(),!1;if(!confirm("Apakah Anda yakin ingin mengembalikan usulan ini ke pegawai untuk perbaikan?"))return!1;const i=e.querySelector('input[name="action_type"]');i&&i.remove();const a=document.createElement("input");a.type="hidden",a.name="action_type",a.value="return_to_pegawai",e.appendChild(a);const o=document.createElement("input");o.type="hidden",o.name="catatan_umum",o.value=t,e.appendChild(o),window.showLoadingState&&window.showLoadingState(),e.submit()},window.validateForwardForm=function(){const e=["nomor_surat_usulan","file_surat_usulan","nomor_berita_senat","file_berita_senat"];let n=[];return e.forEach(t=>{const i=document.getElementById(t);(!i||i.type==="file"&&i.files.length===0||i.type!=="file"&&!i.value.trim())&&n.push(t)}),n.length>0?(alert("Mohon lengkapi semua field yang diperlukan: "+n.join(", ")),!1):!0},window.submitForwardForm=function(){if(window.__DETAIL_PAGE_OVERRIDE_ACTIVE){console.log("Detail page override active - skipping admin-fakultas.js submitForwardForm");return}if(document.getElementById("action-form")){console.log("Detail page detected - skipping admin-fakultas.js submitForwardForm");return}if(document.getElementById("forwardForm")){console.log("Forward form detected - skipping admin-fakultas.js submitForwardForm");return}if(!document.getElementById("validationForm")){console.log("No validation form found - skipping admin-fakultas.js submitForwardForm");return}if(typeof window.validateForwardForm!="function")return console.error("validateForwardForm function not found or not a function"),alert("Sistem validasi tidak tersedia. Silakan refresh halaman."),!1;try{if(!window.validateForwardForm())return!1}catch(e){return console.error("Error in validateForwardForm:",e),alert("Terjadi kesalahan dalam validasi form."),!1}typeof Swal<"u"?Swal.fire({title:"Konfirmasi Pengiriman",html:`
                        <div class="text-left">
                            <p class="mb-3">Apakah Anda yakin ingin <strong>mengirim usulan ini ke universitas</strong>?</p>
                            <div class="bg-yellow-50 border border-yellow-200 rounded p-3 text-sm">
                                <strong>⚠️ Perhatian:</strong>
                                <ul class="mt-2 space-y-1">
                                    <li>• Usulan akan diteruskan ke tingkat universitas</li>
                                    <li>• Dokumen yang sudah dikirim tidak dapat diubah</li>
                                    <li>• Proses ini tidak dapat dibatalkan</li>
                                </ul>
                            </div>
                        </div>
                    `,icon:"question",showCancelButton:!0,confirmButtonColor:"#059669",cancelButtonColor:"#6b7280",confirmButtonText:"Ya, Kirim ke Universitas",cancelButtonText:"Batal",reverseButtons:!0}).then(e=>{e.isConfirmed&&window.processForwardSubmission&&window.processForwardSubmission()}):confirm("Apakah Anda yakin ingin mengirim usulan ini ke universitas?")&&window.processForwardSubmission&&window.processForwardSubmission()},window.processForwardSubmission=function(){const e=document.getElementById("validationForm"),n=document.getElementById("forwardUsulanForm"),t=document.getElementById("uploadProgress"),i=document.getElementById("uploadProgressBar");t&&(t.classList.remove("hidden"),window.animateProgress&&window.animateProgress(i,0,30,500));const a=document.getElementById("file_surat_usulan"),o=document.getElementById("file_berita_senat"),s=1*1024*1024;if(a.files.length>0&&a.files[0].size>s)return window.hideProgress&&window.hideProgress(),typeof Swal<"u"?Swal.fire({icon:"error",title:"File Terlalu Besar",text:"File surat usulan terlalu besar. Maksimal 1MB.",confirmButtonText:"OK"}):alert("File surat usulan terlalu besar. Maksimal 1MB."),!1;if(o.files.length>0&&o.files[0].size>s)return window.hideProgress&&window.hideProgress(),typeof Swal<"u"?Swal.fire({icon:"error",title:"File Terlalu Besar",text:"File berita senat terlalu besar. Maksimal 1MB.",confirmButtonText:"OK"}):alert("File berita senat terlalu besar. Maksimal 1MB."),!1;const r=e.querySelector('input[name="action_type"]');r&&r.remove();const d=document.createElement("input");d.type="hidden",d.name="action_type",d.value="forward_to_university",e.appendChild(d),i&&window.animateProgress&&window.animateProgress(i,30,85,500),n.querySelectorAll("input, textarea, select").forEach(l=>{if(l.name){const f=l.cloneNode(!0);f.style.display="none",e.appendChild(f)}}),i?(window.animateProgress&&window.animateProgress(i,85,100,300),setTimeout(()=>{window.showLoadingState&&window.showLoadingState(),e.submit()},300)):(window.showLoadingState&&window.showLoadingState(),e.submit())},window.animateProgress=function(e,n,t,i){if(!e)return;const a=performance.now(),o=t-n;function s(r){const d=r-a,c=Math.min(d/i,1),l=n+o*c;e.style.width=l+"%",c<1&&requestAnimationFrame(s)}requestAnimationFrame(s)},window.hideProgress=function(){const e=document.getElementById("uploadProgress");e&&e.classList.add("hidden");const n=document.getElementById("uploadProgressBar");n&&(n.style.width="0%")},window.updateValidationIssueSummary=function(){const e=document.getElementById("issueList"),n=document.getElementById("validationIssueSummary");if(!e||!n)return;e.innerHTML="";const t=[];document.querySelectorAll('select[name*="[status]"]').forEach(i=>{if(i.value==="tidak_sesuai"){const a=i.name.match(/validation\[(\w+)\]\[(\w+)\]/);if(a){const o=a[1],s=a[2],r=window.ucwords(o.replace(/_/g," "))+" - "+window.ucwords(s.replace(/_/g," "));t.push(r)}}}),t.length>0?(n.classList.remove("hidden"),t.forEach(i=>{const a=document.createElement("li");a.textContent=i,e.appendChild(a)})):n.classList.add("hidden")},window.showLoadingState=function(){const e=document.createElement("div");e.id="loadingOverlay",e.className="fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50",e.innerHTML=`
                <div class="relative top-1/2 transform -translate-y-1/2 mx-auto p-5 w-96">
                    <div class="bg-white rounded-lg shadow-xl p-6">
                        <div class="flex justify-center items-center">
                            <div class="animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600"></div>
                        </div>
                        <p class="text-center mt-4 text-gray-600">Memproses usulan...</p>
                    </div>
                </div>
            `,document.body.appendChild(e)},window.ucwords=function(e){return e.replace(/\b\w/g,function(n){return n.toUpperCase()})},document.addEventListener("DOMContentLoaded",()=>{document.querySelectorAll('select[name*="[status]"]').forEach(t=>{const i=t.name.match(/validation\[(\w+)\]\[(\w+)\]/);i&&toggleKeterangan(i[1]+"_"+i[2],t.value)}),document.querySelectorAll("select[data-field-id]").forEach(t=>{t.addEventListener("change",function(i){const a=i.target.getAttribute("data-field-id"),o=i.target.value;toggleKeterangan(a,o)})});const e=document.getElementById("file_surat_usulan"),n=document.getElementById("file_berita_senat");e&&e.addEventListener("change",function(t){window.validateFileInput&&window.validateFileInput(t.target,2)}),n&&n.addEventListener("change",function(t){window.validateFileInput&&window.validateFileInput(t.target,5)})}),window.validateFileInput=function(e,n){if(e.files.length>0){const t=e.files[0],i=n*1024*1024;if(t.size>i)return alert(`File terlalu besar. Maksimal ${n}MB.`),e.value="",!1;if(!t.type.includes("pdf"))return alert("File harus berformat PDF."),e.value="",!1}return!0}}}document.addEventListener("DOMContentLoaded",function(){new w});typeof u<"u"&&u.exports&&(u.exports=w);document.addEventListener("DOMContentLoaded",function(){console.log("Admin Fakultas JavaScript loaded")})});export default p();
